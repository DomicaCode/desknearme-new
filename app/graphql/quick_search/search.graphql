query search(
  $limit: Int = 20
  $keyword: String
  $sort: RecordsSortInput = { created_at: { order: DESC } }
  $lang: String
) {
  items: records(
    per_page: $limit
    filter: {
      table: { value: "item" }
      deleted_at: { exists: false }
      properties: { name: "c__status", value_in: ["app.statuses.items.published", "app.statuses.items.unavailable"] }
      related_records: {
        join: { join_on_property: "id", foreign_property: "item_id"}
        filter: {
          table: { value: "item_detail" },
          or: [
            { properties: { name: "name", contains: $keyword } }
            { properties: { name: "description", contains: $keyword } }
          ]
        }
      }
    }
    sort: [$sort]
  ) {
    total_entries
    results {
      id
      created_at
      type: table

      uuid: property(name: "uuid")
      photo: related_record(table: "photo" join_on_property: "uuid" foreign_property: "object_uuid") {
        photo: property_upload(name: "photo") {
          url
          versions
        }
      }
      location_name: property(name: "location_name")
      location_address: property(name: "location_address")
      zip_code: property(name: "zip_code")
      location_type: property(name: "location_type")
      quantity: property(name: "quantity")
      availability: property(name: "availability")
      property_status: property(name: "property_status")
      price_per_hour: property(name: "price_per_hour")
      price_per_day: property(name: "price_per_day")
      price_per_work_week: property(name: "price_per_work_week")
      price_per_calender_week: property(name: "price_per_calender_week")
      price_per_month: property(name: "price_per_month")
      item_detail: related_record(
        table: "item_detail"
        join_on_property: "id"
        foreign_property: "item_id"
        filter: { properties: { name: "lang", value: $lang } }
      ) {
        id
        type: table
        name: property(name: "name")
      }
    }
  }
}
